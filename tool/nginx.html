<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <title>nginx | hehog的博客📚</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="finder.png">
    <link rel="stylesheet" href="/docs/css/style.css">
    <meta name="description" content="hehog的个人博客笔记，记录成长">
    <link rel="preload" href="/docs/assets/css/0.styles.a51286fe.css" as="style"><link rel="preload" href="/docs/assets/js/app.19d86836.js" as="script"><link rel="preload" href="/docs/assets/js/2.42daf74d.js" as="script"><link rel="preload" href="/docs/assets/js/23.a12dd288.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.ffb2f5a2.js"><link rel="prefetch" href="/docs/assets/js/11.0c5b27af.js"><link rel="prefetch" href="/docs/assets/js/12.99edd2a6.js"><link rel="prefetch" href="/docs/assets/js/13.acfb6247.js"><link rel="prefetch" href="/docs/assets/js/14.4c282895.js"><link rel="prefetch" href="/docs/assets/js/15.c1235966.js"><link rel="prefetch" href="/docs/assets/js/16.b43528e0.js"><link rel="prefetch" href="/docs/assets/js/17.90081247.js"><link rel="prefetch" href="/docs/assets/js/18.5b707744.js"><link rel="prefetch" href="/docs/assets/js/19.5121a807.js"><link rel="prefetch" href="/docs/assets/js/20.ac131ffe.js"><link rel="prefetch" href="/docs/assets/js/21.a0469e20.js"><link rel="prefetch" href="/docs/assets/js/22.9027b66d.js"><link rel="prefetch" href="/docs/assets/js/3.84494bec.js"><link rel="prefetch" href="/docs/assets/js/4.f3c8d887.js"><link rel="prefetch" href="/docs/assets/js/5.32437b64.js"><link rel="prefetch" href="/docs/assets/js/6.d6a07974.js"><link rel="prefetch" href="/docs/assets/js/7.fe2c0be3.js"><link rel="prefetch" href="/docs/assets/js/8.36611e3a.js"><link rel="prefetch" href="/docs/assets/js/9.22c6729a.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.a51286fe.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="ant-row"><div class="sidebar-button"><i aria-label="icon: bars" class="anticon anticon-bars"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="bars" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0zm0 284a56 56 0 1 0 112 0 56 56 0 1 0-112 0z"></path></svg></i> <span></span></div> <div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a href="/docs/" class="router-link-active no-logo home-link"><!----> <span class="site-name">hehog的博客📚</span></a> <div class="search-box mobile-search"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div> <div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-18 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><ul role="menu" id="nav" class="ant-menu ant-menu-horizontal ant-menu-root ant-menu-light"><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="/docs/" class="router-link-active">
          首页
        </a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>
          软技能
        </span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="https://juejin.im" target="_blank">
          掘金
          <i aria-label="icon: link" class="anticon anticon-link"><svg viewBox="64 64 896 896" focusable="false" data-icon="link" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M574 665.4a8.03 8.03 0 0 0-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 0 0-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 0 0 0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 0 0 0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 0 0-11.3 0L372.3 598.7a8.03 8.03 0 0 0 0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"></path></svg></i></a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li role="menuitem" class="ant-menu-item"><a href="https://www.zhihu.com" target="_blank">
          知乎
          <i aria-label="icon: link" class="anticon anticon-link"><svg viewBox="64 64 896 896" focusable="false" data-icon="link" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M574 665.4a8.03 8.03 0 0 0-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 0 0-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 0 0 0 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 0 0 0 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 0 0-11.3 0L372.3 598.7a8.03 8.03 0 0 0 0 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"></path></svg></i></a></li><li role="menuitem" class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute;"><div aria-haspopup="true" class="ant-menu-submenu-title"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul> <!----></nav></div></div> <!----></header> <aside class="sidebar"><!----> <!----></aside> <main class="page"> <div class="theme-antdocs-content content__default"><h1 id="nginx"><a href="#nginx" class="header-anchor">#</a> nginx</h1> <p>Mac nginx 配置文件位置:</p> <blockquote><p>/usr/local/etc/nginx</p></blockquote> <p>Mac nginx 安装路径:</p> <blockquote><p>/usr/local/Cellar/nginx</p> <p>/usr/local/var/www</p></blockquote> <h5 id="_1-常用命令"><a href="#_1-常用命令" class="header-anchor">#</a> 1.常用命令</h5> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#启动: </span>
<span class="token function">sudo</span> nginx 
<span class="token comment">#停止: </span>
<span class="token function">sudo</span> nginx -s stop
<span class="token comment">#重新加载配文件: </span>
<span class="token function">sudo</span> nginx -s reload

nginx <span class="token comment">#启动</span>
nginx -t <span class="token comment">#验证配置文件</span>
nginx -s <span class="token comment">#reload 重新加载配置</span>
nginx -s <span class="token comment">#reopen 重启</span>
nginx -s <span class="token comment">#stop 停止</span>
nginx -s <span class="token comment">#quit 退出</span>
nginx -V <span class="token comment">#查看版本，以及配置文件地址</span>
nginx -v <span class="token comment">#查看版本</span>
nginx -c <span class="token comment">#filename 指定配置文件</span>
nginx -h <span class="token comment">#帮助</span>

<span class="token comment">#根据请求客户端的ip的hash值配对选择一个服务器，下次此客户端再次访问时，会配对相同的服务器处理请求</span>
ip_hash<span class="token punctuation">;</span> 
<span class="token assign-left variable">weight</span><span class="token operator">=</span><span class="token number">1</span> 权重
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="linux"><a href="#linux" class="header-anchor">#</a> Linux</h2> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>*******************  Linux *********************
<span class="token function">locate</span> nginx.conf
<span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> nginx
<span class="token function">vi</span> /usr/local/nginx/sbin/
<span class="token builtin class-name">cd</span> /usr/local/nginx/sbin/g
./nginx
<span class="token function">ps</span> aux <span class="token operator">|</span> <span class="token function">grep</span> nginx
<span class="token function">vi</span> /usr/local/nginx/conf/nginx.conf
<span class="token builtin class-name">cd</span> /usr/local/nginx/sbin/
<span class="token function">locate</span> nginx.conf

<span class="token function">which</span> nginx
<span class="token function">whereis</span> nginx
<span class="token comment">#/etc/nginx 默认安装位置</span>
<span class="token comment">#/usr/share/nginx</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="ssl配置"><a href="#ssl配置" class="header-anchor">#</a> ssl配置</h2> <div class="language-nginx line-numbers-mode"><pre class="language-nginx"><code>
<span class="token keyword">upstream</span> gateway <span class="token punctuation">{</span>
  <span class="token keyword">server</span> localhost<span class="token punctuation">:</span><span class="token number">9000</span><span class="token punctuation">;</span>
  <span class="token keyword">server</span> localhost<span class="token punctuation">:</span><span class="token number">9100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment"># http 强制转成https</span>
<span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">listen</span>       <span class="token number">80</span> default_server<span class="token punctuation">;</span>
  <span class="token keyword">server_name</span>  localhost<span class="token punctuation">;</span>
  <span class="token keyword">rewrite</span> <span class="token operator">^</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span>$	<span class="token keyword">https</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$host</span>$<span class="token number">1</span>	permanent<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">listen</span>       <span class="token number">443</span> <span class="token keyword">ssl</span><span class="token punctuation">;</span>
  <span class="token keyword">server_name</span>  www<span class="token punctuation">.</span>kuaidianlai<span class="token punctuation">.</span>cn<span class="token punctuation">;</span>
  <span class="token keyword">root</span>         <span class="token operator">/</span>usr<span class="token operator">/</span>share<span class="token operator">/</span>nginx<span class="token operator">/</span>html<span class="token punctuation">;</span>
  <span class="token comment">#root         /home/project/www;</span>
		
  <span class="token comment"># ssl证书地址</span>
  <span class="token keyword">ssl_certificate</span>     <span class="token string">&quot;/etc/nginx/cert/ssl.pem&quot;</span><span class="token punctuation">;</span>  <span class="token comment"># pem文件的路径</span>
  <span class="token keyword">ssl_certificate_key</span>  <span class="token string">&quot;/etc/nginx/cert/ssl.key&quot;</span><span class="token punctuation">;</span> <span class="token comment"># key文件的路径</span>
  <span class="token keyword">ssl_session_timeout</span>  <span class="token number">5</span>m<span class="token punctuation">;</span>
  <span class="token keyword">ssl_ciphers</span> ECDHE<span class="token operator">-</span>RSA<span class="token operator">-</span>AES128<span class="token operator">-</span>GCM<span class="token operator">-</span>SHA256<span class="token punctuation">:</span>ECDHE<span class="token punctuation">:</span>ECDH<span class="token punctuation">:</span>AES<span class="token punctuation">:</span>HIGH<span class="token punctuation">:</span><span class="token operator">!</span>NULL<span class="token punctuation">:</span><span class="token operator">!</span>aNULL<span class="token punctuation">:</span><span class="token operator">!</span>MD5<span class="token punctuation">:</span><span class="token operator">!</span>ADH<span class="token punctuation">:</span><span class="token operator">!</span>RC4<span class="token punctuation">;</span>    
  <span class="token keyword">ssl_protocols</span> TLSv1 TLSv1<span class="token punctuation">.</span><span class="token number">1</span> TLSv1<span class="token punctuation">.</span><span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">ssl_prefer_server_ciphers</span> on<span class="token punctuation">;</span>
	
	<span class="token keyword">proxy_set_header</span> Host <span class="token variable">$host</span><span class="token punctuation">;</span>
	<span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Real<span class="token operator">-</span>IP <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
	<span class="token keyword">proxy_set_header</span> REMOTE<span class="token operator">-</span>HOST <span class="token variable">$remote_addr</span><span class="token punctuation">;</span>
	<span class="token keyword">proxy_set_header</span> X<span class="token operator">-</span>Forwarded<span class="token operator">-</span>For <span class="token variable">$proxy_add_x_forwarded_for</span><span class="token punctuation">;</span>
	
	
  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
    <span class="token comment"># root   html;</span>
    <span class="token comment"># index  index.html index.htm;</span>
  <span class="token punctuation">}</span>
  
	<span class="token comment">#图片路径拦截,定位到图片静态资源</span>
	<span class="token keyword">location</span> <span class="token operator">~</span> <span class="token operator">/</span>uploads<span class="token operator">/</span><span class="token punctuation">.</span><span class="token operator">*</span>$ <span class="token punctuation">{</span>
	   <span class="token keyword">root</span> <span class="token operator">/</span>www<span class="token operator">/</span><span class="token punctuation">;</span>
	   <span class="token keyword">expires</span> <span class="token number">30</span>d<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token comment">#docker环境配置----------------------------------------</span>
	
  <span class="token comment"># 静态地址</span>
  <span class="token keyword">location</span> <span class="token operator">^</span><span class="token operator">~</span><span class="token operator">/</span>api <span class="token punctuation">{</span>
    <span class="token keyword">proxy_buffering</span> off<span class="token punctuation">;</span>
    <span class="token keyword">rewrite</span> <span class="token operator">^</span><span class="token operator">/</span>api<span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token operator">*</span><span class="token punctuation">)</span>$ <span class="token operator">/</span>$<span class="token number">1</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>gateway<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">#api test测试环境网关</span>
  <span class="token keyword">location</span> <span class="token operator">^</span><span class="token operator">~</span> <span class="token operator">/</span>api<span class="token operator">-</span>test<span class="token operator">/</span> <span class="token punctuation">{</span>
  	<span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">9000</span><span class="token operator">/</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">#动态测试环境</span>
  <span class="token keyword">location</span> <span class="token operator">^</span><span class="token operator">~</span> <span class="token operator">/</span>circle<span class="token operator">/</span> <span class="token punctuation">{</span>
  	<span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">9001</span><span class="token operator">/</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><p>http://kuaidianlaicike.oss-cn-hangzhou.aliyuncs.com/activity/2020-07-22/22849828966849.jpg</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>https://kuaidianlaicike.oss-cn-hangzhou.aliyuncs.com/activity/2020-07-22/22849828966849.jpg

http://qiniu.veryreader.com/D2CrudPlusExample/index.html#/demo/form/uploader/alioss
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main> <!----></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.19d86836.js" defer></script><script src="/docs/assets/js/2.42daf74d.js" defer></script><script src="/docs/assets/js/23.a12dd288.js" defer></script>
  </body>
</html>